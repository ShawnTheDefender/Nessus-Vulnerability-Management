<!--
# Nessus
Nessus Vulnerability Management
-->
![](images/Tenable%2BNessus%2Bbanner.png)

# Nessus Vulnerability Management | Scanning and Remediation

## Project Description

This project demonstrates how to create and manage a virtual environment using VMware and Nessus Essentials. The main objective is to perform vulnerability scans, both basic and credentialed, analyze the results, and apply remediation techniques. This showcases key steps in the Vulnerability Management Lifecycle.

## Project Objectives

1. Provisioning and deprovisioning virtual environments within VMware.
2. Running initial vulnerability scans using Nessus against VMs and observing results.
3. Running credentialed vulnerability scans and comparing/contrasting results.
4. Applying remediation techniques.

## Technologies and Protocols Used

- **VMware Workstation 16 Player**
- **Nessus Essentials**
- **Windows ISO** + **Firefox 3.6.12**

> **Note:** This lab will be conducted on a Windows machine.

## Useful Links

- [VMware Workstation Player](https://www.vmware.com/products/workstation-player/workstation-player-evaluation.html)
- [Nessus Essentials](https://www.tenable.com/products/nessus/nessus-essentials)
- [Windows 10 ISO](https://www.microsoft.com/en-us/software-download/windows10)

## Overview
![](images/nessus_overview.png)

## Step-by-Step Guide

### Step 1: Install Nessus Essentials

#### Step 1.1: Sign Up and Download Nessus Essentials

1. Register for an account on the [Nessus Essentials website](https://www.tenable.com/products/nessus/nessus-essentials).
2. You will receive an activation code via email.
3. Copy the activation code from your email.
4. Click on "Download Nessus" from the website.
5. Choose `Nessus > View Downloads`.
6. Select `Nessus - 8.15.6` under version.
7. Select `Windows - x86_64` under platform (ensure it includes Server 2012 R2, 7, 8, 10).
8. Open Tenable Nessus and follow the installation instructions.
9. After installation, a window with a localhost URL should pop up.
10. Copy/paste the URL for future use.

![](images/S1.1.png)

#### Step 1.2: Finish Nessus Installation

1. Click "Connect via SSL" on the web page.
2. On the warning page, click "Advanced" > "Continue to localhost" > "Nessus Essentials".
3. Skip getting an activation code (we already have ours).
4. Paste the activation code and click "Continue".
5. Create a username and password (remember these for future use).
6. Click "Submit" and wait for the download to complete.

![](images/S1.2.png)

## Step 2: Download Windows 10 ISO File

1. Go to the [Windows 10 ISO download page](https://www.microsoft.com/en-us/software-download/windows10).
2. Click "Download now" and open the downloaded file.
3. Accept the license terms and choose "Create installation media".
4. Finish the setup and select "ISO file".
5. Wait for the download to complete and click "Finish".

![](images/S2.png)

## Step 3: Download VMware Workstation 16 Player

1. Go to the [VMware Workstation Player download page](https://www.vmware.com/products/workstation-player/workstation-player-evaluation.html).
2. Download and install VMware Workstation 16 Player.

## Step 4: Set Up Virtual Machine

1. Open VMware Workstation.
2. Click `Player > File > New Virtual Machine`.
3. For the Installer disc image file (ISO), browse and select your Windows 10 ISO.
4. Click `Next`, `Next`, then accept the default maximum disk size.
5. Click on `Customize Hardware`.
6. Under `Customize Hardware`, set RAM to 4 GB.
7. Under Network Adapter, choose `Bridged`.
8. Click `Close` and then `Finish`.
9. Open your VM and follow the steps to install Windows.
10. **Remember your username and password** when you create an account.

![](images/S4.1.png)

## Step 5: Configure Virtual Machine

### Step 5.1: Initial Configuration

1. Let’s scan our VM to see if you get any response - later we’ll do a more powerful credential scan.
2. Go to your VM, search for `CMD` to open the command line.
3. Use `ipconfig` to get your IPv4 address.

![](images/S5.1.png)

### Step 5.2: Firewall Configuration

1. In your VM, search for `wf.msc` to open Windows Defender Firewall properties.
2. Under Domain Profile tab, Private Profile tab, and Public Profile tab, turn the firewalls OFF.

![](images/S5.2.png)

### Step 5.3: Check for Connectivity

1. On your **host** machine, open a command prompt.
2. Ping your VM's IP address obtained in the previous step.
3. With the firewalls turned off, you should receive a response indicating successful connectivity.

## Step 6: Basic Nessus Scan

1. Sign into Nessus Essentials.
2. Click "Create a new scan".
3. Under Vulnerabilities, choose "Basic Network Scan".
4. Name the scan `Windows 10 Single Host` and paste the VM's IP address in the targets field.
5. Leave the rest of the settings as default.
6. Click "Save". You should see the scan configuration on the next page.
7. Scroll over and click the play button to start the scan.
8. Wait for the scan to complete.

![](images/S6.1.png)

## Step 7: Basic Scan Results

1. Click on the completed scan to view detailed results.
2. The initial scan might not return much information but will still provide some interesting fields.

![](images/S7.1.png)

3. Click on the "Vulnerabilities" tab to see identified issues.
4. You may find one medium severity vulnerability and several informational vulnerabilities.

![](images/S7.2.png)

5. When you click on the medium severity vulnerability, you may find “SMB Signing not required”.
6. Nessus provides a description and solution for this vulnerability.

![](images/S7.3.png)

> Next, we will configure our VM for a stronger, credentialed scan to uncover more vulnerabilities.

### Step 5.3: Check for Connectivity

1. On your **host** machine, open a command prompt.
2. Ping your VM's IP address obtained in the previous step.
3. With the firewalls turned off, you should receive a response indicating successful connectivity.

## Step 6: Basic Nessus Scan

1. Sign into Nessus Essentials.
2. Click "Create a new scan".
3. Under Vulnerabilities, choose "Basic Network Scan".
4. Name the scan `Windows 10 Single Host` and paste the VM's IP address in the targets field.
5. Leave the rest of the settings as default.
6. Click "Save". You should see the scan configuration on the next page.
7. Scroll over and click the play button to start the scan.
8. Wait for the scan to complete.

![](images/S6.1.png)

## Step 7: Basic Scan Results

1. Click on the completed scan to view detailed results.
2. The initial scan might not return much information but will still provide some interesting fields.

![](images/S7.1.png)

3. Click on the "Vulnerabilities" tab to see identified issues.
4. You may find one medium severity vulnerability and several informational vulnerabilities.

![](images/S7.2.png)

5. When you click on the medium severity vulnerability, you may find “SMB Signing not required”.
6. Nessus provides a description and solution for this vulnerability.

![](images/S7.3.png)

> Next, we will configure our VM for a stronger, credentialed scan to uncover more vulnerabilities.

## Step 8: Configuring VM for Credentialed Scan

### Step 8.1: Enable Remote Registry Service

1. On your VM, search for `services`.
2. Find and click `Remote Registry`.
3. Under Startup type, choose `Automatic`.
4. Click `Apply` and then `Start`.
5. This will allow Nessus to **crawl** through our VM registry and perform a more thorough scan.

![](images/S8.1.png)

### Step 8.2: Change User Account Control Settings

1. Search for `User Account Control`.
2. Change the setting to `Never Notify`.

![](images/S8.2.png)

> **Note:** These settings are not recommended in any other context; they are just for demo and lab purposes.

### Step 8.3: Add Registry Key for Enhanced Connectivity

1. Search for `Registry Editor`.
2. Navigate to `LOCAL_MACHINE > SOFTWARE > Microsoft > Windows > CurrentVersion > Policies > System`.
3. Right-click under `System` and create a new `DWORD (32-bit) Value`.
4. Name it `LocalAccountTokenFilterPolicy`.
5. Double-click it and set the value to `1`.
6. Restart your VM.

![](images/S8.3.png)

## Step 9: Configure Credentialed Scan on Nessus

### Step 9.1: Set Up Credentials in Nessus

1. Back in Nessus, select our original scan and click `More` at the top, then choose `Configure`.
2. Under the `Credentials` tab, select `Windows`.
3. Ensure that `Password` is selected and enter your VM's username and password.
4. Go back to `My Scans` and hit the play button to run the credentialed scan.

![](images/S9.1.png)

### Step 9.2: Review Credentialed Scan Results

1. After clicking on our new credentialed scan, you can already notice a significant difference!
2. Our basic scan returned 1 medium vulnerability, but our credentialed scan returned:
   - 2 critical vulnerabilities
   - 9 high vulnerabilities
   - 19 medium vulnerabilities
   - 1 low vulnerability
3. Click into the `History` tab to compare the pie chart of our two scans.

![](images/S9.2.png)

> This highlights the importance of running a credentialed scan.

### Step 9.3: Potential Quick Remediations

1. In the `Remediations` tab, Nessus recommends two high-level actions that would address most of our specific vulnerabilities.
2. Instead of addressing each vulnerability individually, these two actions could potentially cover most vulnerabilities.
3. It appears that a couple of quick updates/patching would do the trick.
4. This is something for vulnerability managers to consider in the future.

![](images/S9.3.png)

> Patching/updating these systems would fix many of our vulnerabilities.

## Step 10: Add Deprecated Software for Additional Scanning

1. To spice up another scan, we can download an old version of Firefox from [here](https://ftp.mozilla.org/pub/firefox/releases/3.6.12/win32/en-US/).
2. **Note:** Download this onto your VM.
3. Download the first `3.6.12.exe` file you see.
4. Install Firefox 3.6.12 (2015 version) on your VM as shown below:

![](images/S10.png)

## Step 11: Launch Another Scan

1. Back on Nessus, go to `My Scans` and launch the same scan. This time, we don’t need to make any new configurations.
2. Give it some time to complete.

![](images/S11.png)

## Step 12: Scan Results After Installing Deprecated Firefox

1. Let’s compare our three scans now:
   
   - **First, our default out-of-the-box scan:**
     ![](images/S12.1.png)
   
   - **Next, our more robust, credentialed scan:**
     ![](images/S12.2.png)
   
   - **And finally, our credentialed scan with an old version of Firefox installed:**
     ![](images/S12.3.png)

2. What a world of difference! Our initial credentialed scan returned 1% critical vulnerabilities, but our scan with the OLD Firefox returned 13% critical vulnerabilities.

![](images/S12.4.png)

> This demonstrates the significant impact that deprecated software can have on system vulnerabilities.

## Key Takeaway

With the inclusion of deprecated software, we saw a 13x jump in critical vulnerabilities. An easy fix to these vulnerabilities would be to simply uninstall the software. This highlights the importance of keeping your software and systems patched and updated in the real world.

## Step 13: System Remediations Through Updates and Patching

1. Back on your VM, search for and run `appwiz.cpl`.
2. Choose Firefox 3.6.12 and click `Uninstall`.
3. Go back to search, type `Windows Update`, and check for updates.
4. Click `Install now` for any available updates.
5. After installing updates and restarting your VM, check again for updates.
6. After installing any new updates, restart your VM again to ensure all patches are applied.

![](images/S13.png)

## Step 14: Run Final Scan and Compare

1. Back on Nessus, run our scan one final time.
2. We should see a number of remediations after the scan is complete.
3. Let’s compare our initial credentialed scan to our most recent scan in the history tab - these two are the most consistent.
   
   - **Our initial, default credentialed scan:**
     ![](images/S14.1.png)

> This scan returned 6% high and 14% medium vulnerabilities.

- Our remediated credential scan: 

![](images/S14.2.png)

> In comparison, our final scan returned only 2% high and 10% medium vulnerabilities. 

- Simply updating Windows remediated more than half of our high vulnerabilities.

## Final Step: Further Possible remediations
- Take a look at the Vulnerabilities tab 
- Internet explorer still has some high/mixed vulnerabilities. 
- What else can we do to take care of these vulnerabilities? Possibly more updates …

![](images/S15.png)
